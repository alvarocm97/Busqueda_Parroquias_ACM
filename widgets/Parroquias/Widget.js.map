{"version":3,"sources":["../../../widgets/Parroquias/Widget.js"],"names":["define","declare","BaseWidget","QueryTask","Query","lang","SpatialReference","Graphic","SimpleFillSymbol","SimpleMarkerSymbol","SimpleLineSymbol","Color","baseClass","name","postCreate","inherited","arguments","console","log","startup","onOpen","cargaConcellos","codigoProvincia","selectProvincias","value","selectConcellos","innerHTML","queryTask","config","servicioConcellos","query","returnGeometry","outFields","orderByFields","where","execute","hitch","results","opt","document","createElement","text","add","i","features","length","attributes","CODCONC","CONCELLO","cargaParroquias","codigoConcello","selectParroquias","queryTask1","servicioParroquias","query1","opt1","CODPARRO","PARROQUIA","zoomConcello","queryTask2","query2","outSpatialReference","geom","geometry","map","graphics","clear","STYLE_SOLID","setExtent","getExtent","zoomParroquia","codigoParroquia","queryTask3","query3","graficoParroquia","STYLE_CROSS","onClose","resize"],"mappings":"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","file":"Widget.js","sourcesContent":["define(['dojo/_base/declare', 'jimu/BaseWidget', \"esri/tasks/QueryTask\", \"esri/tasks/query\", 'dojo/_base/lang', \"esri/SpatialReference\", \"esri/graphic\", \"esri/symbols/SimpleFillSymbol\", \"esri/symbols/SimpleMarkerSymbol\", \"esri/symbols/SimpleLineSymbol\", \"esri/Color\"],\r\nfunction(declare, BaseWidget, QueryTask, Query, lang, SpatialReference, Graphic, SimpleFillSymbol, SimpleMarkerSymbol, SimpleLineSymbol, Color) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'parroquias',\r\n    // this property is set by the framework when widget is loaded.\r\n    name: 'Parroquias',\r\n    // add additional properties here\r\n\r\n    //methods to communication with app container:\r\n    postCreate: function() {\r\n      this.inherited(arguments);\r\n      console.log('Parroquias::postCreate');\r\n    },\r\n\r\n    startup: function() {\r\n      this.inherited(arguments);\r\n      console.log('Parroquias::startup');\r\n    },\r\n\r\n    onOpen: function(){\r\n      console.log('Parroquias::onOpen');\r\n    },\r\n\r\n    cargaConcellos: function(){\r\n      console.log(\"cargaConcellos\")\r\n\r\n      let codigoProvincia = this.selectProvincias.value;\r\n\r\n      if(codigoProvincia == -1) return;\r\n\r\n      this.selectConcellos.innerHTML = \"\";\r\n\r\n      const queryTask = new QueryTask(this.config.servicioConcellos);\r\n\r\n      const query = new Query();\r\n      query.returnGeometry = false;\r\n      query.outFields = [\"CODCONC\", \"CONCELLO\"];\r\n      query.orderByFields = [\"CONCELLO\"];\r\n      query.where = \"CODPROV = \" + codigoProvincia;\r\n\r\n      queryTask.execute(query, lang.hitch(this, function(results){\r\n        console.log(results)\r\n        \r\n        let opt = document.createElement(\"option\");\r\n\r\n        opt.value = -1;\r\n\r\n        opt.text = \"Seleccione concello\";\r\n\r\n        this.selectConcellos.add(opt);\r\n\r\n        for (let i = 0; i < results.features.length; i++){\r\n\r\n          opt = document.createElement(\"option\");\r\n\r\n          opt.value = results.features[i].attributes.CODCONC;\r\n\r\n          opt.text = results.features[i].attributes.CONCELLO;\r\n\r\n          this.selectConcellos.add(opt);\r\n        }\r\n      }));\r\n    },\r\n\r\n    cargaParroquias: function(){\r\n      console.log(\"cargaParroquias\", this.selectConcellos)\r\n\r\n      let codigoConcello = this.selectConcellos.value;\r\n\r\n      console.log(this.selectConcellos.value)\r\n\r\n      if(codigoConcello == -1) return;\r\n\r\n      this.selectParroquias.innerHTML = \"\";\r\n\r\n      const queryTask1 = new QueryTask(this.config.servicioParroquias);\r\n\r\n      const query1 = new Query();\r\n      query1.returnGeometry = false;\r\n      query1.outFields = [\"CODPARRO\", \"PARROQUIA\"];\r\n      query1.orderByFields = [\"PARROQUIA\"];\r\n      query1.where = \"CODCONC = \" + codigoConcello;\r\n\r\n      queryTask1.execute(query1, lang.hitch(this, function(results){\r\n        console.log(\"Entro\")\r\n        \r\n        let opt1 = document.createElement(\"option\");\r\n\r\n        opt1.value = -1;\r\n\r\n        opt1.text = \"Seleccione parroquia\";\r\n\r\n        this.selectParroquias.add(opt1);\r\n\r\n        for (let i = 0; i < results.features.length; i++){\r\n\r\n          opt1 = document.createElement(\"option\");\r\n\r\n          opt1.value = results.features[i].attributes.CODPARRO;\r\n\r\n          opt1.text = results.features[i].attributes.PARROQUIA;\r\n\r\n          this.selectParroquias.add(opt1);\r\n        }\r\n\r\n      }));\r\n\r\n    },\r\n\r\n    zoomConcello: function(){      \r\n\r\n      let codigoConcello = this.selectConcellos.value;\r\n\r\n      if(codigoConcello == -1) return;\r\n\r\n      const queryTask2 = new QueryTask(this.config.servicioConcellos);\r\n\r\n      const query2 = new Query();\r\n      query2.returnGeometry = true;\r\n      query2.outFields = [\"CODCONC\", \"CONCELLO\"];\r\n      query2.orderByFields = [\"CONCELLO\"];\r\n      query2.where = \"CODCONC = \" + codigoConcello;\r\n      query2.outSpatialReference = new SpatialReference(102100);\r\n\r\n      queryTask2.execute(query2, lang.hitch(this, function(results){\r\n\r\n        if(results.features.length > 0){\r\n\r\n          let geom = results.features[0].geometry;\r\n\r\n          this.map.graphics.clear();\r\n\r\n          this.map.graphics.add(new Graphic(geom, new SimpleFillSymbol(SimpleFillSymbol.STYLE_SOLID, new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID,\r\n            new Color([37,40,80]), 2),new Color([173,216,230,0.25]))          \r\n          ));\r\n\r\n          this.map.setExtent(geom.getExtent(), true)\r\n        }\r\n\r\n      }));\r\n\r\n    },\r\n\r\n    zoomParroquia: function(){\r\n\r\n      let codigoParroquia = this.selectParroquias.value;\r\n\r\n      if(codigoParroquia == -1) return;\r\n\r\n      const queryTask3 = new QueryTask(this.config.servicioParroquias);\r\n\r\n      const query3 = new Query();\r\n      query3.returnGeometry = true;\r\n      query3.outFields = [\"CODPARRO\", \"PARROQUIA\"];\r\n      query3.orderByFields = [\"PARROQUIA\"];\r\n      query3.where = \"CODPARRO = \" + codigoParroquia;\r\n      query3.outSpatialReference = new SpatialReference(102100);\r\n\r\n      queryTask3.execute(query3, lang.hitch(this, function(results){\r\n\r\n        if(results.features.length > 0){\r\n\r\n          let geom = results.features[0].geometry;\r\n\r\n          this.map.graphics.clear();\r\n\r\n          var graficoParroquia = new Graphic(geom, new SimpleMarkerSymbol(SimpleMarkerSymbol.STYLE_CROSS, 12,\r\n            new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID,\r\n            new Color([185,147,90]), 2),\r\n            new Color([185,147,90,0.25]))          \r\n          );\r\n\r\n          this.map.graphics.add(graficoParroquia)\r\n\r\n          this.map.setExtent(geom.getExtent(), true)\r\n        }\r\n\r\n      }));\r\n\r\n    },\r\n\r\n    onClose: function(){\r\n      console.log('Parroquias::onClose');\r\n    },    \r\n\r\n    resize: function(){\r\n      console.log('Parroquias::resize');\r\n    }    \r\n\r\n  });\r\n\r\n});\r\n"]}